<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Play Pong online with friends or AI - a modern take on the classic arcade game">
  <title>Pong.io - Online Pong Game</title>
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  
  <!-- Custom CSS -->
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/game.css">
  <link rel="stylesheet" href="css/dashboard.css">
  <link rel="stylesheet" href="css/privacy.css">
</head>
<body>
  <!-- Background animation canvas will be added via JS -->
  
  <!-- Main application container -->
  <div id="app" class="container-fluid p-0">
    <!-- Language Selection Page -->
    <section id="language-page" class="page active">
      <h2 class="text-center" data-i18n="selectLanguage">Select Language</h2>
      <select id="language-selector" class="button form-select mb-3">
        <option value="en">English</option>
        <option value="es">Español</option>
        <option value="fr">Français</option>
      </select>
      <button id="next-button" class="button btn btn-primary w-100" data-i18n="next">Next</button>
    </section>

    <!-- Game Start Page (Nickname & Round Selection) -->
    <section id="game-page" class="page">
      <h2 id="enter-name" class="text-center" data-i18n="enterName">Enter Your Nickname</h2>
      
      <!-- Player setup form -->
      <form id="game-setup-form" class="mb-3">
        <div class="mb-3">
          <input type="text" id="nickname" class="nickname-input form-control" 
                 placeholder="Enter a cool name" aria-label="Nickname">
        </div>
        <div class="mb-3">
          <input type="number" id="rounds-input" class="rounds-input form-control" 
                 placeholder="Enter rounds" value="3" min="1" max="20" aria-label="Number of rounds">
        </div>
      </form>

      <!-- Join Game Button with mode selection -->
      <div class="queue-wrapper d-flex align-items-center justify-content-center">
        <button type="button" id="prevMode" class="btn btn-link" aria-label="Previous game mode">
          <i class="fa fa-caret-left"></i>
        </button>
        <button id="start-game" class="button join-game-button hidden" aria-label="Start game">
          <div class="button-text" data-i18n="joinGame">JOIN GAME</div>
          <div class="game-mode-indicator">Classic with queue</div>
        </button>
        <button type="button" id="nextMode" class="btn btn-link" aria-label="Next game mode">
          <i class="fa fa-caret-right"></i>
        </button>
      </div>

      <!-- Waiting Players Section -->
      <div id="waiting-players-container" class="card bg-transparent mt-3">
        <div class="card-body">
          <h3 class="card-title h5 mb-2">
            Currently Waiting Players 
            <small class="text-muted">(click to join)</small>
          </h3>
          <ul id="waiting-players-list" class="list-group list-group-flush bg-transparent" 
              aria-label="Waiting players list"></ul>
        </div>
      </div>
      
      <!-- Navigation buttons -->
      <div class="mt-3">
        <button id="leaderboard-button" data-navigate="leaderboard-page" 
                class="button btn btn-secondary w-100" data-i18n="leaderboard">
          Leaderboard
        </button>
        
        <button id="privacy-policy-button" data-navigate="privacy-policy-page" 
                class="button btn btn-secondary mt-2 w-100" data-i18n="privacyPolicy">
          Privacy Policy / GDPR
        </button>
      </div>
    </section>

    <!-- Custom Game Page -->
    <section id="custom-game-page" class="page">
      <h2 class="text-center">Custom Game</h2>
      
      <!-- Code input section -->
      <div class="code-input-section mb-3">
        <label for="game-code" class="form-label">Game Code</label>
        <div class="input-group">
          <input type="text" id="game-code" class="form-control" placeholder="Enter special code...">
          <button id="apply-code" class="btn btn-primary">Apply</button>
        </div>
        <div class="d-flex justify-content-between mt-1">
          <button id="generate-code" class="btn btn-sm btn-info">Generate Code</button>
          <button id="copy-code" class="btn btn-sm btn-secondary">Copy to Clipboard</button>
        </div>
      </div>
      
      <!-- Presets -->
      <div class="preset-section mb-3">
        <label class="form-label">Quick Presets</label>
        <div class="d-flex flex-wrap gap-2 justify-content-center">
          <button class="preset-button btn btn-sm btn-outline-danger" data-preset="speed">Speedemon</button>
          <button class="preset-button btn btn-sm btn-outline-info" data-preset="retro">Retro</button>
          <button class="preset-button btn btn-sm btn-outline-warning" data-preset="giant">Giant Paddles</button>
          <button class="preset-button btn btn-sm btn-outline-success" data-preset="micro">Micro Mode</button>
          <button class="preset-button btn btn-sm btn-outline-primary" data-preset="chaos">Chaos</button>
        </div>
      </div>
      
      <!-- Customization Options -->
      <div class="customization-section">
        <!-- Ball Speed -->
        <div class="option-row mb-3">
          <label for="ball-speed" class="form-label">Ball Speed: <span id="ball-speed-value">4</span></label>
          <input type="range" class="form-range" id="ball-speed" min="2" max="10" step="0.5" value="4">
        </div>
        
        <!-- Paddle Size -->
        <div class="option-row mb-3">
          <label for="paddle-size" class="form-label">Paddle Size: <span id="paddle-size-value">100%</span></label>
          <input type="range" class="form-range" id="paddle-size" min="50" max="200" step="10" value="100">
        </div>
        
        <!-- Speed Increment -->
        <div class="option-row mb-3">
          <label for="speed-increment" class="form-label">Speed Increment: <span id="speed-increment-value">0.5</span></label>
          <input type="range" class="form-range" id="speed-increment" min="0" max="2" step="0.1" value="0.5">
        </div>
        
        <!-- Colors -->
        <div class="row mb-3">
          <div class="col">
            <label for="ball-color" class="form-label">Ball Color</label>
            <input type="color" class="form-control form-control-color" id="ball-color" value="#00d4ff">
          </div>
          <div class="col">
            <label for="left-paddle-color" class="form-label">Left Paddle</label>
            <input type="color" class="form-control form-control-color" id="left-paddle-color" value="#007bff">
          </div>
          <div class="col">
            <label for="right-paddle-color" class="form-label">Right Paddle</label>
            <input type="color" class="form-control form-control-color" id="right-paddle-color" value="#ff758c">
          </div>
        </div>
        
        <!-- Physics Options -->
        <div class="form-check mb-2">
          <input class="form-check-input" type="checkbox" id="gravity-enabled">
          <label class="form-check-label" for="gravity-enabled">
            Enable Gravity Effect
          </label>
        </div>
        
        <div class="form-check mb-3">
          <input class="form-check-input" type="checkbox" id="bounce-random">
          <label class="form-check-label" for="bounce-random">
            Random Bounce Angles
          </label>
        </div>
      </div>
      
      <!-- Start Game Button -->
      <button id="start-custom-game" class="button btn btn-primary w-100 mt-3">Start Custom Game</button>
      
      <!-- Back Button -->
      <button id="back-to-menu" data-navigate="game-page" class="button btn btn-secondary mt-2 w-100">Back to Menu</button>
    </section>

    <!-- Pong Game Page -->
    <section id="pong-page" class="page">
      <!-- Game Overlay for Fullscreen Info -->
      <div id="game-overlay" class="position-absolute">
        <div id="overlay-player-name" class="text-center"></div>
        <div id="overlay-score" class="text-center"></div>
      </div>
      
      <!-- Mini info display for when game is minimized -->
      <div id="game-info" class="game-info">
        <span id="player-name"></span> | Rounds: <span id="player-rounds">0</span> / <span id="target-rounds">0</span>
      </div>
      
      <!-- Game canvas -->
      <canvas id="pong-canvas" class="w-100" aria-label="Pong game canvas"></canvas>

      <div class="d-flex justify-content-between mt-3">
        <button id="end-game" class="button btn btn-secondary hidden">Leave Game</button>
      </div>
      
      <h3 id="pong-status" class="message text-center mt-3" data-i18n="waitingOpponent">Waiting for an opponent...</h3>
    </section>

    <!-- Leaderboard Page -->
    <section id="leaderboard-page" class="page">
      <h2 class="text-center" data-i18n="leaderboard">Leaderboard</h2>
      <div class="card bg-transparent mb-3">
        <div class="card-body p-0">
          <ul id="leaderboard" class="leaderboard-list list-group list-group-flush" 
              aria-label="Player leaderboard"></ul>
        </div>
      </div>
      <button id="back-button" data-navigate="game-page" class="button btn btn-secondary w-100" 
              data-i18n="back">Back</button>
    </section>

    <!-- Privacy Policy Page -->
    <section id="privacy-policy-page" class="page">
      <h2 class="text-center" data-i18n="privacyPolicy">Privacy Policy</h2>
      
      <div class="privacy-content">
        <div class="privacy-section mb-3">
          <h3>What Data We Collect</h3>
          <p>
            We collect minimal data necessary to provide the Pong game service:
          </p>
          <ul>
            <li>Nickname (publicly visible)</li>
            <li>Game statistics (wins, losses, total games)</li>
            <li>Temporary session data</li>
          </ul>
        </div>
        
        <div class="privacy-section mb-3">
          <h3>How We Use Your Data</h3>
          <p>
            Your data is used solely to:
          </p>
          <ul>
            <li>Display game statistics on leaderboards</li>
            <li>Track game history and performance</li>
            <li>Improve the game experience</li>
          </ul>
          <p>
            We do not sell or share your data with third parties.
          </p>
        </div>
        
        <div class="privacy-section mb-3">
          <h3>Your Rights</h3>
          <p>
            Under GDPR, you have the right to:
          </p>
          <ul>
            <li>Access your personal data</li>
            <li>Correct inaccurate data</li>
            <li>Delete your data ("right to be forgotten")</li>
          </ul>
        </div>
        
        <div class="privacy-section mb-3">
          <h3>Delete Your Data</h3>
          <p>
            To delete all your game data, please enter your nickname below. This action cannot be undone.
          </p>
          
          <div class="alert alert-warning">
            <strong>Warning:</strong> This will permanently delete all your game statistics and records.
          </div>
          
          <div class="delete-data-form mb-3">
            <div class="mb-3">
              <label for="delete-nickname" class="form-label">Your Nickname:</label>
              <input type="text" id="delete-nickname" class="form-control" placeholder="Enter nickname">
            </div>
            
            <button id="generate-verification" class="btn btn-warning mb-3">Generate Verification Code</button>
            
            <div id="verification-section" class="mb-3" style="display: none;">
              <div class="verification-instructions alert alert-info">
                <p>To confirm your identity, please enter the following verification code:</p>
                <div id="verification-code" class="verification-code"></div>
              </div>
              
              <div class="mb-3">
                <label for="verification-input" class="form-label">Verification Code:</label>
                <input type="text" id="verification-input" class="form-control" placeholder="Enter verification code">
              </div>
              
              <button id="confirm-delete" class="btn btn-danger">Delete My Data</button>
            </div>
          </div>
        </div>
      </div>
      
      <div id="delete-result" class="alert" style="display: none;"></div>
      
      <button id="privacy-back-button" data-navigate="game-page" class="button btn btn-secondary w-100" 
              data-i18n="back">Back</button>
    </section>
  </div>

  <!-- Bootstrap JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- Application JS Files -->
  <script src="js/utils/utils.js"></script>
  
  <!-- Core modules -->
  <script src="js/core/i18n-manager.js"></script>
  <script src="js/core/page-manager.js"></script>
  <script src="js/core/api-service.js"></script>
  <script src="js/core/websocket-service.js"></script>
  
  <!-- Game modules -->
  <script src="js/game/pong-engine.js"></script>
  <script src="js/game/pong-renderer.js"></script>
  <script src="js/game/background-animation.js"></script>
  
  <!-- Controllers -->
  <script src="js/controllers/game-controller.js"></script>
  <script src="js/controllers/custom-game-controller.js"></script>
  <script src="js/controllers/leaderboard-controller.js"></script>
  <script src="js/controllers/privacy-controller.js"></script>
  
  <!-- Main app initialization -->
  <script src="js/app.js"></script>
</body>
</html>